<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Login Process Flow — Demo</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#005fcc;--muted:#6b7280}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); color:#111; margin:0; padding:24px}
    .container{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:360px 1fr;gap:20px}

    /* Flow sidebar */
    .flow{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.06)}
    .flow h2{margin:0 0 12px;font-size:18px}
    .step-list{display:flex;flex-direction:column;gap:10px}
    .step{display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;border:1px solid transparent}
    .step:focus{outline:3px solid rgba(0,95,204,0.15)}
    .step.active{background:linear-gradient(90deg, rgba(0,95,204,0.06), rgba(0,95,204,0.02));border-color:rgba(0,95,204,0.12)}
    .node{width:44px;height:44px;border-radius:8px;background:var(--accent);color:#fff;display:grid;place-items:center;font-weight:700}
    .step-title{font-weight:600}
    .step-desc{font-size:13px;color:var(--muted)}

    /* Canvas area */
    .canvas{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.06)}
    .canvas h2{margin:0 0 12px;font-size:18px}
    .panel{border:1px dashed #e6edf8;border-radius:10px;padding:14px;background:linear-gradient(180deg, #fff, #fbfdff)}

    label{display:block;margin-top:10px;font-size:13px;color:var(--muted)}
    select,input[type="text"]{width:100%;padding:10px;border-radius:8px;border:1px solid #d6e4fb;margin-top:6px;font-size:14px}
    .result{margin-top:12px;padding:10px;border-radius:8px;background:#f3f7ff;border:1px solid #e6eefc}

    /* small helper */
    .hint{font-size:13px;color:var(--muted);margin-top:6px}
    .controls{display:flex;gap:8px;margin-top:12px}
    button{padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
    button.secondary{background:#eef4ff;color:var(--accent);border:1px solid rgba(0,95,204,0.08)}

    /* responsive */
    @media (max-width:880px){.container{grid-template-columns:1fr;}}
  </style>
</head>
<body>
  <div class="container">
    <aside class="flow" aria-label="Login process steps">
      <h2>Login Process (click a step)</h2>
      <div class="step-list" role="list">
        <button class="step" role="listitem" data-step="1" aria-controls="panel" tabindex="0">
          <div class="node">1</div>
          <div>
            <div class="step-title">Open login page</div>
            <div class="step-desc">Confirm URL and site certificate</div>
          </div>
        </button>

        <button class="step" role="listitem" data-step="2" aria-controls="panel" tabindex="0">
          <div class="node">2</div>
          <div>
            <div class="step-title">Enter username / email</div>
            <div class="step-desc">Is email recognized?</div>
          </div>
        </button>

        <button class="step" role="listitem" data-step="3" aria-controls="panel" tabindex="0">
          <div class="node">3</div>
          <div>
            <div class="step-title">Enter password</div>
            <div class="step-desc">Check caps lock / special characters</div>
          </div>
        </button>

        <button class="step" role="listitem" data-step="4" aria-controls="panel" tabindex="0">
          <div class="node">4</div>
          <div>
            <div class="step-title">Two-factor (if enabled)</div>
            <div class="step-desc">SMS / Authenticator / Email</div>
          </div>
        </button>

        <button class="step" role="listitem" data-step="5" aria-controls="panel" tabindex="0">
          <div class="node">5</div>
          <div>
            <div class="step-title">Access account</div>
            <div class="step-desc">Landing on dashboard</div>
          </div>
        </button>
      </div>
    </aside>

    <main class="canvas">
      <h2>Interactive panel</h2>
      <div id="panel" class="panel" tabindex="0" aria-live="polite">
        <p class="hint">Select a step on the left to see conditional troubleshooting paths and dropdowns.</p>

        <!-- Dynamic content gets injected here -->
        <div id="dynamic-area">
          <p class="hint">No step selected yet — try clicking <strong>Enter username / email</strong>.</p>
        </div>

      </div>
    </main>
  </div>

  <script>
    // Data model for steps and conditional options
    const STEPS = {
      1: {
        title: 'Open login page',
        description: 'Confirm URL and site certificate',
        controls: [
          { id: 'env', label: 'Which environment?', type: 'select', options: ['Production', 'Staging', 'Local dev'], hint: 'Important when reproducing issues.' }
        ]
      },
      2: {
        title: 'Enter username / email',
        description: 'Is email recognized?',
        controls: [
          { id: 'recognized', label: 'Is the email recognized?', type: 'select', options: ['Yes — login proceeds', 'No — suggest sign-up', 'Unknown'], hint: 'Choose to see the next recommended action.' }
        ],
        conditional: function(values){
          // If user says email not recognized, show recommended message
          if(values.recognized === 'No — suggest sign-up'){
            return { result: 'Show article: "How to sign up and register your email"', escalate: false };
          }
          if(values.recognized === 'Yes — login proceeds'){
            return { result: 'Proceed to password step', escalate: false };
          }
          return { result: 'Ask user to confirm the spelled email and check spam invites', escalate: false };
        }
      },
      3: {
        title: 'Enter password',
        description: 'Check caps lock / special characters',
        controls: [
          { id: 'caps', label: 'Is caps lock on?', type: 'select', options: ['No', 'Yes'], hint: '' },
          { id: 'reset', label: 'Try password reset?', type: 'select', options: ['No', 'Yes — send reset link'], hint: 'If the user cannot remember password.' }
        ],
        conditional: function(values){
          if(values.reset && values.reset.startsWith('Yes')){
            return { result: 'Trigger password reset flow and show reset article', escalate: false };
          }
          if(values.caps === 'Yes'){
            return { result: 'Advise to toggle caps lock and retry', escalate: false };
          }
          return { result: 'Ask user to try again or reset password', escalate: false };
        }
      },
      4: {
        title: 'Two-factor (if enabled)',
        description: 'SMS / Authenticator / Email',
        controls: [
          { id: 'method', label: 'Which 2FA method?', type: 'select', options: ['SMS', 'Authenticator app', 'Email link'], hint: 'Some methods are slower or blocked.' },
          { id: 'code', label: 'Did code arrive?', type: 'select', options: ['Yes', 'No — not received'], hint: '' }
        ],
        conditional: function(values){
          if(values.code === 'No — not received'){
            return { result: 'Check delivery logs, advise retry or alternative method', escalate: true };
          }
          return { result: 'Complete login — successful 2FA verification', escalate: false };
        }
      },
      5: {
        title: 'Access account',
        description: 'Landing on dashboard',
        controls: [
          { id: 'landing', label: 'Is dashboard fully loaded?', type: 'select', options: ['Yes', 'Partial (missing widgets)', 'No — error'], hint: '' }
        ],
        conditional: function(values){
          if(values.landing && values.landing.startsWith('No')){
            return { result: 'Collect console logs, send to engineering', escalate: true };
          }
          if(values.landing && values.landing.startsWith('Partial')){
            return { result: 'Try hard refresh, check feature flags', escalate: false };
          }
          return { result: 'Happy path — user is logged in', escalate: false };
        }
      }
    };

    // DOM refs
    const stepButtons = document.querySelectorAll('.step');
    const dynamicArea = document.getElementById('dynamic-area');
    const panel = document.getElementById('panel');

    // Helper: clear active
    function clearActive(){
      stepButtons.forEach(b=>b.classList.remove('active'));
    }

    // Render controls for a step
    function renderStep(stepId){
      const step = STEPS[stepId];
      clearActive();
      const btn = document.querySelector(`.step[data-step='${stepId}']`);
      btn.classList.add('active');

      // Build HTML
      let html = `<h3 style="margin:0">${escapeHtml(step.title)}</h3>
                  <p class="hint" style="margin:6px 0 12px">${escapeHtml(step.description)}</p>`;

      html += '<form id="step-form" aria-label="Step form">';

      step.controls.forEach(ctrl=>{
        if(ctrl.type === 'select'){
          html += `<label for="${ctrl.id}">${escapeHtml(ctrl.label)}</label>`;
          html += `<select id="${ctrl.id}" name="${ctrl.id}">`;
          html += `<option value="">-- choose --</option>`;
          ctrl.options.forEach(opt=> html += `<option value="${escapeHtml(opt)}">${escapeHtml(opt)}</option>`);
          html += '</select>';
          if(ctrl.hint) html += `<div class="hint">${escapeHtml(ctrl.hint)}</div>`;
        } else if(ctrl.type === 'text'){
          html += `<label for="${ctrl.id}">${escapeHtml(ctrl.label)}</label>`;
          html += `<input type="text" id="${ctrl.id}" name="${ctrl.id}" />`;
        }
      });

      html += '<div class="controls">';
      html += '<button type="button" id="apply">Apply</button>';
      html += '<button type="button" class="secondary" id="reset">Reset</button>';
      html += '</div>';
      html += '</form>';

      html += '<div id="out" class="result" role="status" aria-live="polite" style="display:none"></div>';

      dynamicArea.innerHTML = html;

      // Hook events
      document.getElementById('apply').addEventListener('click', ()=>{
        const form = document.getElementById('step-form');
        const data = Object.fromEntries(new FormData(form).entries());
        const ctx = (typeof step.conditional === 'function') ? step.conditional(data) : { result: 'No conditional defined', escalate: false };
        const out = document.getElementById('out');
        out.style.display = 'block';
        out.innerHTML = `<strong>Recommended action:</strong> ${escapeHtml(ctx.result)}${ctx.escalate ? '<br><em>Escalation required</em>' : ''}`;
      });

      document.getElementById('reset').addEventListener('click', ()=>{
        document.getElementById('step-form').reset();
        const out = document.getElementById('out'); out.style.display='none';
      });

      // focus panel for accessibility
      panel.focus();
    }

    // wire up step click
    stepButtons.forEach(b=>{
      b.addEventListener('click', ()=> renderStep(b.dataset.step));
      b.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); renderStep(b.dataset.step); }
      });
    });

    // small helper to sanitize
    function escapeHtml(str){
      if(!str) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    // initial selection (optional)
    // renderStep(2);
  </script>
</body>
</html>